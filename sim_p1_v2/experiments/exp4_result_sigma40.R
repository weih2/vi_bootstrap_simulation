# result.coverage = scan()
0.934790 0.938431 0.940748 0.941468 0.943065 0.946044 0.947037 0.946759 0.949074 0.948413 0.949455 0.949175 0.948287 0.948009 0.948667 0.944882 0.939692 0.937070 0.933792 0.934185 0.938114 0.936212 0.936539 0.936725 0.938742 0.939720 0.941023 0.943249 0.946784 0.946510 0.948192 0.949446 0.951028 0.953603 0.959163 0.963297 0.964475 0.966337 0.966667 0.966337 0.967784 0.964427 0.953932 0.952240 0.950495 0.944939 0.944226 0.942913 0.944008 0.948214 0.952759
0.854353 0.853691 0.852367 0.849537 0.846739 0.846739 0.843760 0.839947 0.836640 0.828704 0.819623 0.810561 0.797431 0.781178 0.764067 0.742782 0.728614 0.715503 0.704031 0.702030 0.703667 0.710500 0.726202 0.736791 0.744868 0.753666 0.756272 0.752120 0.744368 0.734508 0.738351 0.770711 0.813908 0.865745 0.911023 0.945279 0.961819 0.968977 0.972277 0.965347 0.956607 0.952899 0.950642 0.948617 0.951815 0.946588 0.938320 0.938648 0.937132 0.940020 0.943508
0.853360 0.857001 0.858987 0.858466 0.860973 0.866931 0.872228 0.874339 0.877976 0.881614 0.883713 0.883828 0.880764 0.880882 0.880882 0.873031 0.864962 0.855785 0.843658 0.829404 0.805501 0.787373 0.773634 0.762231 0.760834 0.748778 0.744868 0.734508 0.727718 0.714938 0.712936 0.722440 0.746327 0.776571 0.803121 0.833166 0.846282 0.843564 0.844224 0.854455 0.863248 0.883070 0.901612 0.915020 0.927723 0.937356 0.940617 0.942585 0.941061 0.941658 0.942517
0.948185 0.951155 0.951203 0.951533 0.949885 0.944609 0.940711 0.938406 0.933465 0.928665 0.924869 0.921010 0.920354 0.918795 0.924361 0.928431 0.936010 0.943034 0.949870 0.955404 0.961840 0.956209 0.946784 0.941618 0.934181 0.933268 0.938477 0.942652 0.946798 0.952094 0.960446 0.960134 0.959827 0.963109 0.967784 0.971043 0.972113 0.974308 0.971043 0.971014 0.964286 0.958003 0.952428 0.949704 0.947195 0.946917 0.944664 0.947126 0.944226 0.941929 0.941601
0.817162 0.807591 0.795582 0.784042 0.764590 0.741840 0.722991 0.699605 0.682477 0.669625 0.661417 0.660111 0.666339 0.671906 0.681729 0.700000 0.712047 0.722982 0.740885 0.755534 0.748858 0.733007 0.709762 0.670581 0.643858 0.659831 0.700846 0.756924 0.821018 0.887102 0.930358 0.951424 0.959163 0.962780 0.963182 0.969069 0.971129 0.971344 0.969727 0.969038 0.963624 0.958664 0.951437 0.946417 0.947525 0.945598 0.943347 0.940887 0.938976 0.937664 0.939304
0.727393 0.729703 0.730959 0.733597 0.734586 0.730300 0.725626 0.718379 0.703557 0.671269 0.641076 0.611275 0.587348 0.575966 0.572037 0.578758 0.585047 0.586589 0.580729 0.568359 0.559361 0.534967 0.518446 0.488911 0.469860 0.478190 0.505859 0.540241 0.588177 0.639531 0.692022 0.737688 0.775232 0.812582 0.837936 0.860809 0.873031 0.879117 0.878908 0.870883 0.868056 0.875992 0.888338 0.904997 0.920462 0.935048 0.943017 0.944499 0.946194 0.946194 0.947178 
n.obs = c( rep(500, 153), rep(1000, 153))

# the following only contain vb results         

result.coverage200 = scan()
0.971029 0.973307 0.977865 0.978516 0.980794 0.980794 0.980794 0.980469 0.980143 0.977214 0.976237 0.973307 0.970703 0.964193 0.959635 0.955078 0.952474 0.948242 0.945964 0.944010 0.940755 0.941081 0.937174 0.937500 0.935872 0.934245 0.934570 0.935872 0.933268 0.932292 0.935221 0.936523 0.938802 0.941732 0.945312 0.944987 0.947917 0.952474 0.952474 0.958984 0.963542 0.964518 0.966471 0.950521 0.942383 0.939453 0.940104 0.941081 0.945312 0.948893 0.958659 
0.873047 0.872070 0.869466 0.870443 0.869466 0.864583 0.862630 0.857422 0.841146 0.818359 0.797526 0.772461 0.747721 0.726562 0.702799 0.688477 0.682943 0.683268 0.689453 0.703776 0.717773 0.731445 0.745768 0.759440 0.769857 0.784831 0.796549 0.810872 0.821615 0.833333 0.852865 0.872070 0.882812 0.881836 0.861003 0.841471 0.824870 0.823242 0.824544 0.832357 0.851237 0.869141 0.892253 0.947266 0.944661 0.944661 0.943685 0.940430 0.941406 0.947591 0.952148 
0.811523 0.815755 0.820638 0.825195 0.827148 0.830729 0.833659 0.840495 0.847331 0.851562 0.860352 0.862630 0.865234 0.865234 0.860352 0.841797 0.821940 0.795898 0.776367 0.759766 0.745117 0.741536 0.746094 0.738932 0.729492 0.714518 0.695638 0.682292 0.671549 0.663411 0.661784 0.676107 0.679036 0.684245 0.690104 0.690430 0.697266 0.697591 0.707682 0.717122 0.742839 0.777344 0.813477 0.890951 0.916341 0.927734 0.940104 0.942708 0.947917 0.947591 0.946940 


result.coverage100 = scan()
0.960938 0.962891 0.964193 0.966471 0.970052 0.974935 0.977539 0.978841 0.978841 0.978841 0.976237 0.975260 0.975260 0.968750 0.967448 0.964518 0.958984 0.956055 0.953125 0.946940 0.944661 0.944010 0.943034 0.941406 0.938151 0.936849 0.936523 0.937500 0.939453 0.940755 0.942057 0.942057 0.941406 0.940430 0.942383 0.942708 0.946615 0.947591 0.948893 0.956706 0.961914 0.966797 0.972005 0.974609 0.962891 0.954427 0.950195 0.950195 0.954102 0.962891 0.969401 
0.888021 0.887044 0.884440 0.883789 0.884766 0.881510 0.878255 0.873372 0.868490 0.859701 0.842448 0.822266 0.796224 0.779622 0.754557 0.725260 0.702148 0.693034 0.685547 0.684570 0.689779 0.696940 0.704427 0.710938 0.727865 0.743490 0.755534 0.768555 0.779622 0.792969 0.815104 0.846680 0.860677 0.878581 0.889323 0.884440 0.864909 0.842448 0.824870 0.821940 0.833008 0.851562 0.868490 0.885417 0.941081 0.952474 0.945638 0.942708 0.942057 0.943685 0.938802 
0.861979 0.864583 0.867513 0.872396 0.875651 0.878906 0.883464 0.886719 0.891276 0.894531 0.900716 0.905273 0.910482 0.911784 0.911784 0.910156 0.904622 0.897461 0.871419 0.851562 0.838216 0.821940 0.800130 0.787760 0.778971 0.777995 0.764974 0.751953 0.739583 0.724284 0.710612 0.707357 0.702474 0.705078 0.707357 0.700846 0.698242 0.694661 0.691732 0.708008 0.734701 0.767904 0.799805 0.836263 0.901693 0.929688 0.943685 0.944661 0.946615 0.946615 0.939128 

result.coverage500 = scan()
0.955729 0.957682 0.960938 0.963542 0.966471 0.968099 0.968424 0.969727 0.968424 0.967448 0.966797 0.963216 0.960286 0.959310 0.959961 0.958333 0.958333 0.958659 0.955404 0.955729 0.955729 0.955729 0.953776 0.950521 0.951172 0.954427 0.953125 0.954427 0.957031 0.954753 0.958008 0.958659 0.958008 0.954753 0.954102 0.952148 0.950846 0.950846 0.952474 0.956706 0.955729 0.948568 0.950195 0.947591 0.946615 0.940755 0.941406 0.940430 0.941081 0.944987 0.948893 
0.847331 0.842448 0.842122 0.836263 0.828125 0.813151 0.797526 0.774089 0.748372 0.724935 0.706706 0.693685 0.686523 0.681966 0.686198 0.695312 0.701823 0.710286 0.723958 0.739909 0.759766 0.769206 0.777669 0.783203 0.762695 0.728516 0.710286 0.715169 0.734049 0.766602 0.787435 0.798177 0.795247 0.809245 0.822591 0.827799 0.839844 0.853516 0.864583 0.872721 0.948242 0.950195 0.949870 0.948893 0.945964 0.944987 0.944336 0.942383 0.944661 0.944010 0.950195 
0.783203 0.784831 0.790365 0.796224 0.801107 0.805339 0.812500 0.817383 0.818034 0.815104 0.798828 0.784505 0.754557 0.730794 0.705729 0.690104 0.683594 0.680664 0.680013 0.678711 0.673503 0.666341 0.652018 0.618490 0.590495 0.570964 0.559570 0.555990 0.565755 0.580404 0.609701 0.629883 0.652018 0.675130 0.691732 0.702799 0.711589 0.721680 0.726237 0.742513 0.815755 0.856445 0.879232 0.907878 0.919922 0.930664 0.937174 0.941081 0.945964 0.945638 0.948568

result.coverage1000 = scan()
0.966797 0.971680 0.972331 0.972982 0.974284 0.974609 0.974609 0.971029 0.969076 0.965169 0.963542 0.962565 0.962565 0.963216 0.963216 0.962240 0.961914 0.961263 0.959310 0.961263 0.959310 0.961589 0.963216 0.963542 0.965820 0.966146 0.968099 0.971029 0.968099 0.967448 0.965820 0.963867 0.961263 0.962240 0.959635 0.955078 0.953125 0.952148 0.951172 0.949544 0.949219 0.948242 0.947266 0.945964 0.946615 0.948568 0.949544 0.947917 0.946940 0.947917 0.947917 
0.845703 0.833984 0.821289 0.808268 0.792318 0.773438 0.747721 0.721680 0.707031 0.692383 0.682617 0.678385 0.683268 0.685872 0.693685 0.707031 0.726888 0.743164 0.763672 0.780273 0.789714 0.787109 0.775065 0.746419 0.727865 0.731445 0.753906 0.778971 0.828125 0.876953 0.913411 0.946940 0.960612 0.967773 0.963216 0.959310 0.956380 0.953776 0.949219 0.949219 0.946940 0.944336 0.945638 0.945638 0.945312 0.947591 0.951497 0.948242 0.947917 0.946940 0.949219 
0.754232 0.760091 0.763021 0.766276 0.767904 0.767904 0.761068 0.743490 0.718424 0.693359 0.665690 0.635742 0.621094 0.611654 0.613281 0.621094 0.624023 0.629232 0.633789 0.625326 0.618490 0.600260 0.585938 0.560221 0.551107 0.549479 0.565755 0.583984 0.606445 0.636068 0.675456 0.718099 0.756510 0.779948 0.792643 0.804362 0.809570 0.809570 0.804362 0.803385 0.820638 0.847982 0.875651 0.900391 0.921549 0.933919 0.942057 0.949544 0.952799 0.952799 0.952799 


result.coverage = c(coverage1, result.coverage100, coverage2, result.coverage200)
result.coverage = c(coverage3, result.coverage500, coverage4, result.coverage1000)

result.lab = rep( rep(c("Gibbs Sampler", "VWLB CI", "VWLB CI2", "VB posterior"), 
                 each = length(test.seq)), 2)
result.x.lab = seq(0.1, 10, by = 0.1)

log.test.seq = log(test.seq)

n.obs = c(rep("100 obs", 51 * 4), rep("200 obs", 51 * 4))


n.obs = c(rep("500 obs", 51 * 4), rep("1000 obs", 51 * 4))
n.obs = factor(n.obs, levels = c("500 obs", "1000 obs"))

result.df = data.frame(coverage = result.coverage, credible.set.type = result.lab, 
                       delta = test.seq, n.obs = n.obs)

result.df.log = data.frame(coverage = result.coverage, credible.set.type = result.lab, 
                           log.delta = log.test.seq, n.obs = n.obs)
library(ggplot2)
# color
ggplot(data = result.df, 
       mapping = aes(x = delta, y = coverage, color = lab)) + geom_line() +
  facet_wrap(~n.obs)

  # linetype
ggplot(data = result.df, 
       mapping = aes(x = delta, y = coverage,shape = credible.set.type, color = credible.set.type,
                     linetype = credible.set.type)) + geom_line()+
    geom_point(size = 0.8) + facet_wrap(~n.obs) + theme_grey(base_size = 20) +
scale_shape_discrete(solid=F) +
scale_linetype_manual(values=c("solid", "dotdash", "longdash", "dotted")) +
  scale_color_manual(values=c("#999999", "#FF0000", "#0000FF", "#000000")) +
  ylim(0.5, 1) + guides(shape = guide_legend(title = "CS type"),
    linetype = guide_legend(title = "CS type"), 
                        color = guide_legend(title = "CS type"))
